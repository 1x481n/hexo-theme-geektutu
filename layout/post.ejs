---
layout: page
---
<style>
    .sidebar {
        background-color: transparent;
    }

    .sidebar,
    .sidebar>div {
        width: 320px;
        float: left;
    }

    .sidebar section {
        margin-left: 10px;
        background: white;
        overflow: auto;
        margin-bottom: 8px;
        padding: 8px 10px;
        max-height: 380px;
        -ms-overflow-style: none;
        overflow: -moz-scrollbars-none;
    }

    .sidebar section::-webkit-scrollbar {
        width: 0 !important;
    }

    .sidebar ul {
        line-height: 1.35;
    }

    .sidebar ul>li {
        list-style-type: square;
    }

    .sidebar ol>li {
        list-style-type: circle;
    }

    .sidebar a {
        color: rgba(0, 0, 0, 0.9);
        font-size: 14px;
    }

    .sidebar-active {
        color: #337ab7 !important;
        font-weight: bold;
    }

    .sidebar-fixed {
        position: fixed;
        top: -70px;
        margin-top: 0;
        z-index: 1;
    }

    .sidebar-rec {
        text-align: center;
    }
</style>
<style>
    .post-container {
        overflow: hidden;
        background: white;
    }

    .post-item-date {
        margin-left: 10px;
        color: hsla(0, 0%, 71%, .9);
        font-size: 0.85em;
    }

    .series_links {
        border: 1px solid #eaecef;
        padding: 15px;
        background-color: #fff8dc;
        margin-bottom: 20px;
        border-radius: 5px;
    }
</style>
<!-- Post Content -->
<div class="col-xs-12 post-container box-shadow">
    <article class="col-xs-12">
        <h1> <%- page.title %> </h1>

        <% var categories = (page.categories || []).map(item => item)%>

        <% if (categories.length){  var category = categories[0] %>
        <div class="hidden-lg hidden-md series_links">
            <p> <strong> <%= category.name %>系列文章链接：</strong></p>
            <ul>
                <% category.posts.sort('date').map(function(post, index){ %>
                <li>
                    <a href="<%= config.root %><%- post.path %>"><%- post.title || "Untitled" %></a>
                    <span class="post-item-date">(<%= post.date.format('ll') %>)</span>
                </li>
                <% }) %>
            </ul>
        </div>
        <% } %>
        <% if(page.github) { %>
        <blockquote>
            <p>源代码/数据集已上传到
                <a href="<%= page.github %>" target="_blank" rel="noopener">
                    Github - <%= page.github.split('/')[4] %>
                </a>
            </p>
        </blockquote>
        <% } %>
        <% var file_name = page.path.split('/').reverse()[0] %>
        <%- page.content %>
        <!-- 文章末尾的提示 start -->
        <% if (config.post_tips && config.post_tips.find_me ) {%>
        <p>
            本站永久域名<strong>「 <a href="<%= config.root %><%= page.path %>"><%= config.url.split('/').reverse()[0]%></a>
                」</strong>，也可搜索<strong>「 <%= config.title %> 」</strong>找到我。
        </p>
        <% }%>
        <% if (config.post_tips && config.post_tips.zhihu_zhuanlan ) {%>
        <p>期待关注我的<strong>「 <a href="<%= config.post_tips.zhihu_zhuanlan %>">知乎专栏</a>」</strong>，所有文章可在<strong>「 知乎APP
                」</strong>查看。</p>
        <% }%>
        <!-- 文章末尾的提示 end -->
        <%-partial('_widget/generate-qrcode') %>
        <hr>
        <div>
            <p>
                <span><%- __('tags')%>: </span>
                <% page.tags.each(function(tag) { %>
                <a href="<%- config.root%>tags/#<%- tag.name%>">
                    <code key="<%- tag.name%>" class="post-label">#<%- tag.name%></code>
                </a>
                <% }) %>
            </p>
            <% if ((page.categories || []).length){ %>
            <p>
                <span><%- __('categories')%>: </span>
                <% page.categories.each(function(category) { %>
                <a href="<%- config.root%>series/#<%- category.name%>">
                    <code key="<%- category.name%>" class="post-label"><%- category.name%></code>
                </a>
                <% }) %>
            </p>
            <% } %>
            <p>
                <span>发表于<%= page.date.format('YYYY-MM-DD HH:mm:ss') %>，最后修改于<%= page.updated.format('YYYY-MM-DD HH:mm:ss') %>。</span>
            </p>
            <p><span>本站文章欢迎链接分享，禁止全文转载。</span></p>
        </div>
        <hr />
        <%-partial('_partial/prev-next-post') %>
    </article>
    <!-- 赞赏 -->
    <%- partial('_widget/reward') %>
    <!-- 推荐阅读三篇文章 -->
    <div class="col-xs-12">
        <h3>推荐阅读</h3>
        <%  let randomInt = (max) => Math.floor(Math.random() * Math.floor(max));
                    let choices = []
                    let posts = []
                    if (site.posts.length >= 3) {
                        while(choices.length < 3) {
                            let num = randomInt(site.posts.length);
                            choices.indexOf(num) === -1 && choices.push(num)
                        }
                    } else {
                        choices = [0, 1, 2]
                    }
                    site.posts.sort('date').reverse().each(function(post, i){
                        if (choices.indexOf(i) !== -1) { 
            
                    %>
        <%- partial('_widget/post-preview', {post: post}) %>
        <% }}); %>
    </div>
    <div class="col-xs-12">
        <!-- 标签列表 -->
        <%- partial('_widget/featured-tags') %>
    </div>
    <!-- 评论 -->
    <div class="col-xs-12">
        <%- partial('_widget/comments') %>
    </div>
</div>
<aside class="sidebar hidden-xs hidden-sm">
    <div style="clear: both"></div>
    <div class="sidebar-wrapper">
        <section class="box-shadow"><%- partial('_widget/summary') %></section>
        <% var categories = (page.categories || []).map(item => item)%>
        <% if (categories.length){  var category = categories[0] %>
        <section class="sidebar-content box-shadow">
            <strong><%= category.name %></strong>
            <ul>
                <% category.posts.sort('date').map(function(post, index){ %>
                <li>
                    <a href="<%= config.root %><%- post.path %>"
                        class="<%= post.path===page.path ? 'sidebar-active':''%>"><%= post.title.split(' - ').reverse()[0] %></a>
                    <% if(post.path == page.path) { %>
                    <%- partial('_partial/toc') %>
                    <% }; %>
                </li>
                <% }) %>
            </ul>
        </section>
        <% } %>
        <% var recentSize = categories.length ? 5 : 10 %>
        <section class="box-shadow">
            <strong>最近的文章</strong>
            <ul>
                <% site.posts.sort('date').reverse().slice(0, recentSize).map(function(post, index){ %>
                <li>
                    <a href="<%= config.root %><%- post.path %>"><%= post.title.split(' - ').reverse()[0] %></a>
                </li>
                <% }) %>
            </ul>
        </section>

        <section class="box-shadow sidebar-rec">
            <%- partial('_widget/google-ad', {type: '250'}) %>
            <%- partial('_widget/google-ad', {type: '250'}) %>
        </section>
    </div>
</aside>
<script>
    (function () {
        var ele = document.querySelector('.sidebar-content')
        var wrapper = document.querySelector('.sidebar-wrapper')
        var last = 0
        window.addEventListener("scroll", function (e) {
            var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
            var isDown = scrollTop > last;
            var pos = getPosition(ele).y - scrollTop;
            var downLimit = 50;
            var upLimit = -100;

            console.log(pos)

            isDown && pos <= downLimit && wrapper.classList.add("sidebar-fixed");
            !isDown && pos > upLimit && wrapper.classList.remove("sidebar-fixed");
            last = scrollTop
        })
    })();
</script>